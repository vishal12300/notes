#### On the other hand, being able to use PowerShell will give you the power of an object-oriented programming language readily available on the target platform.

There are several PowerShell scripts useful in penetration tests, such as PowerView and Nishang; however, please remember these two points about them;

* They are detected by most antivirus software

## Manipulating Files

#### Start-Process

The ` Start-Process ` command can be used to start a process. You can see an example below for notepad.exe.

```
Start-Process notepad.exe
```

#### Get-Process
Get-Process is useful to list all running processes.
```
Get-Process -Name notepad
Get-Process | Export-Csv process_list.csv
Get-Contnet process_list.csv
```

#### Copy-Item

Files can be copied and moved with “Copy-Item” and “Move-Item”, respectively.

#### Get-FileHash
Although not directly related to penetration tests, hashes are handy to compare files or search for malware samples on platforms such as VirusTotal. The built-in “Get-FileHash” command can be used to obtain hashes on most formats.

## Run the POwershell script 
We can't run the powershell script directly becouse of Execution policy. But we can bypass this. 
```
powershell -ExecutionPloicy Bypass -File .\meterpreter.ps1
```

Another option could be to use “Set-ExecutionPolicy Bypass” with the scope set for the process. The “-scope” parameter will set the execution policy only for the current PowerShell session and will go back to the initial settings once the PowerShell session is closed.

#### “Invoke-WebRequest”
Another easy way to download files from a remote server is to use the “Invoke-WebRequest” command.

####  Format-List
Format-List” can also be used to gather more information about objects. Below are three examples using a simple “dir” command.

#### Out-File
Out-File can be used to save the output to a file for further use.

## Scan Network 
```
 1..15 | %{echo "10.10.81.$_"; ping -n 1 10.10.81.$_ | Select-String ttl}
```

## Scan Open Port 
```
1..1024 |%{echo ((New-Object Net.Sockets.TcpClient).Connect("10.0.2.8",$_)) "Open port on $_ "} 2>$null
```
